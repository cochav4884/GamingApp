<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="node_modules/bootstrap/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="styles/Home.css" />
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <title>Gaming App</title>
  </head>

  <body>
    <!-- Left Sidebar -->
    <div id="LobbySidebar" class="sidebar-left Lobby">
      <a href="javascript:void(0)" class="closebtn" onclick="closeNavLobby()"
        >&times;</a
      >
      <div class="lobby-title">Lobby</div>
      <section>
        Player List
        <ul>
          <li>Creator</li>
          <li>Host</li>
          <li>Player 1</li>
          <li>Player 2</li>
          <li>Player 3</li>
          <li>Player 4</li>
          <li>Player 5</li>
          <li>Player 6</li>
          <li>Player 7</li>
          <li>Player 8</li>
          <li>Player 9</li>
          <li>Player 10</li>
        </ul>
      </section>
      <div>
        Dice Box
        <div class="dice">Roll Dice</div>
      </div>
    </div>

    <!-- Left Sidebar Tab -->
    <div id="LobbyTab" class="sidebar-tab" onclick="openNavLobby()">Lobby</div>

    <!-- Right Sidebar #1 -->
    <div id="BackgroundSidebar" class="sidebar-right BackgroundImages">
      <a
        href="javascript:void(0)"
        class="closebtn"
        onclick="closeNavBackground()"
        >&times;</a
      >
      <div class="lobby-title">Background Images</div>
      <section>
        <ul id="backgroundList"></ul>
      </section>
    </div>

    <!-- Right Sidebar Tab #1 -->
    <div
      id="BackgroundTab"
      class="sidebar-tab-right BackgroundImages"
      onclick="openNavBackground()"
    >
      Background
    </div>

    <!-- Right Sidebar #2 -->
    <div id="AssetsSidebar" class="sidebar-right Assets">
      <a href="javascript:void(0)" class="closebtn" onclick="closeNavAssets()"
        >&times;</a
      >
      <div class="lobby-title">Assets</div>
      <section>
        Choose Asset
        <ul id="assetList"></ul>
      </section>
    </div>

    <!-- Right Sidebar Tab #2 -->
    <div
      id="AssetsTab"
      class="sidebar-tab-right Assets"
      onclick="openNavAssets()"
    >
      Assets
    </div>

    <!-- Main content -->
    <div id="main">
      <h1>Battlefield</h1>

      <!-- Battlefield container -->
      <div id="battlefield">
        <!-- Grid squares will be generated dynamically by JS -->
        <div id="gridOverlay" class="grid-overlay"></div>

        <!-- Fullscreen buttons -->
        <button id="fullscreenBtn" type="button" class="btn btn-secondary">
          FullScreen
        </button>
        <button
          id="exitFullscreenBtn"
          type="button"
          class="btn btn-danger hidden"
        >
          Exit FullScreen
        </button>
      </div>

      <p>
        Main content area. Open any sidebar using the tabs. Both right sidebars
        are independent.
      </p>
    </div>

    <script>
      // -------------------- Sidebar Functions --------------------
      function openNavLobby() {
        document.getElementById("LobbySidebar").style.width = "250px";
        document.getElementById("main").classList.add("left-open");
        document.getElementById("LobbyTab").style.display = "none";
      }
      function closeNavLobby() {
        document.getElementById("LobbySidebar").style.width = "0";
        document.getElementById("main").classList.remove("left-open");
        document.getElementById("LobbyTab").style.display = "block";
      }

      function openNavBackground() {
        document.getElementById("BackgroundSidebar").style.width = "250px";
        document.getElementById("main").classList.add("right1-open");
        document.getElementById("BackgroundTab").style.display = "none";
      }
      function closeNavBackground() {
        document.getElementById("BackgroundSidebar").style.width = "0";
        document.getElementById("main").classList.remove("right1-open");
        document.getElementById("BackgroundTab").style.display = "block";
      }

      function openNavAssets() {
        document.getElementById("AssetsSidebar").style.width = "250px";
        document.getElementById("main").classList.add("right2-open");
        document.getElementById("AssetsTab").style.display = "none";
      }
      function closeNavAssets() {
        document.getElementById("AssetsSidebar").style.width = "0";
        document.getElementById("main").classList.remove("right2-open");
        document.getElementById("AssetsTab").style.display = "block";
      }

      // -------------------- Fullscreen --------------------
      const battlefield = document.getElementById("battlefield");
      const fullscreenBtn = document.getElementById("fullscreenBtn");
      const exitFullscreenBtn = document.getElementById("exitFullscreenBtn");

      fullscreenBtn.addEventListener("click", () => {
        battlefield.classList.add("fullscreen");
        fullscreenBtn.style.display = "none";
        exitFullscreenBtn.style.display = "block";
      });

      exitFullscreenBtn.addEventListener("click", () => {
        battlefield.classList.remove("fullscreen");
        fullscreenBtn.style.display = "block";
        exitFullscreenBtn.style.display = "none";
      });

      // -------------------- Backgrounds --------------------

      // Set the battlefield background
      function setBattlefieldBackground(imagePath) {
        const battlefield = document.getElementById("battlefield");
        battlefield.style.backgroundImage = `url('${imagePath}')`;
        battlefield.style.backgroundSize = "cover";
        battlefield.style.backgroundPosition = "center";
      }

      // Array of all background image filenames
      const backgroundImages = [
        "Abandoned-Building.jpg",
        "Abandoned-Quarry.jpg",
        "Abandoned-Village.jpg",
        "Acid-Cave.jpg",
        "Amethyst-Fortress.jpg",
        "Ancient-Courtyard.jpg",
        "Beach-Cove.jpg",
        "Beach-Front.jpg",
        "Brimstone-Path.jpg",
        "Brimstone-Plateu.jpg",
        "Cathedral-Ruins.jpg",
        "Demon-Lair.jpg",
        "Dessert-Ruins.jpg",
        "Farm.jpg",
        "Farm-2.jpg",
        "Forest-Glade.jpg",
        "Forest-Ruins.jpg",
        "Forgotten-Crypt.jpg",
        "Forgotten-Monastery.jpg",
        "Fort.jpg",
        "Fort-2.jpg",
        "Galleon-Ship.jpg",
        "Glacier-Castle.jpg",
        "Haunted-Garden.jpg",
        "Infernal-Tomb.jpg",
        "Jungle-Path.jpg",
        "Jungle-Ruins.jpg",
        "Jungle-Ruins-2.jpg",
        "Lost-Temple.jpg",
        "Market.jpg",
        "Market-2.jpg",
        "Moat-Checkpoint.jpg",
        "Multen-Arena.jpg",
        "Nest.jpg",
        "Obsidian-Fortress.jpg",
        "Reprieve.jpg",
        "River-Crossings.jpg",
        "River-Fort.jpg",
        "Rocky-Path.jpg",
        "Rose-Court.jpg",
        "Ship-Yard.jpg",
        "Shipwreck.jpg",
        "Slate-Path.jpg",
        "Snow-Fort.jpg",
        "Snow-Fort-2.jpg",
        "Spider-Cave.jpg",
        "Spider-Dwelling.jpg",
        "Spider-Fortress.jpg",
        "Stone-Beach.jpg",
        "Twisting-Trail.jpg",
        "Typical-Tavern.jpg",
        "Village.jpg",
        "War-Zone.jpg",
        "War-Zone-2.jpg",
        "Winter-Forest.jpg",
        "Winter-Forest-2.jpg",
        // Add all other filenames up to 56
      ];

      // Generate the list dynamically
      const backgroundList = document.getElementById("backgroundList");

      backgroundImages.forEach((image) => {
        const li = document.createElement("li");
        li.textContent = image.replace(/-/g, " ").replace(".jpg", ""); // Clean display name
        li.style.cursor = "pointer";
        li.onclick = () => setBattlefieldBackground(`images/${image}`);
        backgroundList.appendChild(li);
      });

      // -------------------- Assets --------------------
      const assets = [
        { id: 1, name: "Treasure Chest", x: null, y: null, found: false },
        { id: 2, name: "Magic Sword", x: null, y: null, found: false },
        { id: 3, name: "Potion", x: null, y: null, found: false },
      ];

      const assetList = document.getElementById("assetList");
      assets.forEach((asset) => {
        const li = document.createElement("li");
        li.textContent = asset.name;
        li.draggable = true;
        li.dataset.id = asset.id;
        li.style.cursor = "grab";
        li.addEventListener("dragstart", (e) =>
          e.dataTransfer.setData("text/plain", asset.id)
        );
        assetList.appendChild(li);
      });

      // -------------------- Grid Squares --------------------
      const gridOverlay = document.createElement("div");
      gridOverlay.id = "gridOverlay";
      gridOverlay.style.position = "absolute";
      gridOverlay.style.top = 0;
      gridOverlay.style.left = 0;
      gridOverlay.style.width = "100%";
      gridOverlay.style.height = "100%";
      document.getElementById("battlefield").appendChild(gridOverlay);

      const gridWidth = 50; // number of squares horizontally
      const gridHeight = 50; // number of squares vertically

      for (let y = 0; y < gridHeight; y++) {
        for (let x = 0; x < gridWidth; x++) {
          const square = document.createElement("div");
          square.classList.add("grid-square");
          square.dataset.x = x;
          square.dataset.y = y;

          square.addEventListener("dragover", (e) => e.preventDefault());

          square.addEventListener("drop", (e) => {
            e.preventDefault();
            const assetId = e.dataTransfer.getData("text/plain");
            const asset = assets.find((a) => a.id == assetId);

            // Remove previous asset if already placed
            square.innerHTML = "";

            // Place the icon image in the square
            const img = document.createElement("img");
            img.src = asset.image;
            img.alt = asset.name;
            img.classList.add("placed-asset-img");
            square.appendChild(img);

            // Update asset coordinates
            asset.x = square.dataset.x;
            asset.y = square.dataset.y;
            asset.found = true;

            console.log(`Placed ${asset.name} at (${asset.x}, ${asset.y})`);
          });

          gridOverlay.appendChild(square);
        }
      }
    </script>
  </body>
</html>